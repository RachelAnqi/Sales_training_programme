shiny::runApp('Documents/server')
shiny::runApp('Documents/server')
library(rsconnect)
library(rsconnect)
shiny::runApp('Documents/server')
shiny::runApp('Documents/server')
shiny::runApp('Documents/project/sales_training/simplified_server/server')
shiny::runApp('Documents/project/sales_training/server3')
load("~/Documents/project/sales_training/server3/initial_setting.R.RData")
paste("已分配时间",sr_info_initial_value$sales_rep[4],"(天)",sep="")
paste("已分配时间 ",sr_info_initial_value$sales_rep[4],"(天)",sep="")
setwd("~/Documents/project/sales_training/simplified_server/server/server2")
setwd("~/Documents/project/sales_training/simplified_server/server4/")
setwd("~/Documents/project/sales_training/server4")
list.files()
sr_info <- read.xlsx("pre_info.xlsx",
sheet="sales_rep")
library(tidyr)
library(plyr)
library(dplyr)
library(openxlsx)
options(scipen=200)
sr_info <- read.xlsx("pre_info.xlsx",
sheet="sales_rep")
View(s-info)
View(sr_info)
colnames(sr_info)
sr_info_ui <- sr_info[,1:4]
sr_info_ui
product_info <- read.xlsx("pre_info.xlsx",
sheet="product")
colnames(product_info)
hospital_info <- read.xlsx("pre_info.xlsx",
sheet="hosptial")
hospital_info <- read.xlsx("pre_info.xlsx",
sheet="hospital")
View(hospital_info)
x<- gather(hospital_info,phase,"潜力",c("周期1","周期2","周期3","周期4"))
View(x)
hospital_info<- gather(hospital_info,phase,"潜力",c("周期1","周期2","周期3","周期4"))
colnames(hospital_info)
pp_info <- read.xlsx("pre_info.xlsx",
sheet="pp_info")
colnames(hospital_info)
distinct(hospital_info$名称)
distinct_(hospital_info$名称)
unique(hospital_info$名称)
head(pp_info,1)
library(tidyr)
library(plyr)
library(dplyr)
library(openxlsx)
options(scipen=200)
## sales representative
sr_info <- read.xlsx("pre_info.xlsx",
sheet="sales_rep")
sr_info_ui <- sr_info[,1:4]
worktime =100
overhead =2
## product information
product_info <- read.xlsx("pre_info.xlsx",
sheet="product")
product_info_ui <- product_info[-1,]
## hospital information
hospital_info <- read.xlsx("pre_info.xlsx",
sheet="hospital")
hospital_info<- gather(hospital_info,phase,"潜力",c("周期1","周期2","周期3","周期4"))
hospital_info_ui <- hospital_info[c(1,3,4,5,7,8),]
## previous period
pp_info <- read.xlsx("pre_info.xlsx",
sheet="pp_info")
## weightage
weightage <- list(total_attractiveness = list(pp_offer_attractiveness = 0.35,
cp_offer_attractiveness = 0.65),
cp_offer_attractiveness = list(sales_performance = 0.6,
customer_relationship = 0.4),
sales_performance = list(sr_sales_performance = 0.6,
field_work = 0.05,
deployment_quality = 0.35),
customer_relaitonship = list(product_knowledge = 0.05,
promotional_support = 0.15,
past_relationship = 0.8),
sr_sales_performance = list(motivation = 0.15,
sales_skills = 0.3,
product_knowledge = 0.05,
time_with_account = 0.5),
deployment_quality = list(kpi_report_analysis =0.4,
admin_work = 0.3,
meetings_with_team = 0.3),
sales_skills = list(field_work = 0.2,
sales_training = 0.3,
experience = 0.5),
motivation = list(admin_work = 0.1,
sales_target_realization =0.4,
meetings_with_team = 0.25,
sales_training = 0.25),
success_value = list(total_sales = 0.3,
contribution_margin = 0.35,
average_customer_relationship = 0.15,
team_capability = 0.2)
)
## total promotional budget
total_promotional_budget <- list(phase1 = 2000,
phase2 = 2000,
phase3 = 2000,
phase4 = 2000)
##
sr_info <- read.xlsx("pre_info.xlsx",
sheet="sales_rep")
library(tidyr)
library(plyr)
library(dplyr)
library(openxlsx)
options(scipen=200)
sr_info <- read.xlsx("pre_info.xlsx",
sheet="sales_rep")
getwd()
list.files()
sr_info <- read.xlsx("pre_info.xlsx",
sheet="sales_rep")
sr_info <- read.xlsx("pre_info.xlsx",
sheet="sales_rep")
sr_info <- read.xlsx("pre_info.xlsx",
sheet="sales_rep")
sr_info_ui <- sr_info[,1:4]
worktime =100
overhead =2
product_info <- read.xlsx("pre_info.xlsx",
sheet="product")
product_info_ui <- product_info[-1,]
hospital_info <- read.xlsx("pre_info.xlsx",
sheet="hospital")
hospital_info<- gather(hospital_info,phase,"潜力",c("周期1","周期2","周期3","周期4"))
hospital_info_ui <- hospital_info[c(1,3,4,5,7,8),]
pp_info <- read.xlsx("pre_info.xlsx",
sheet="pp_info")
weightage <- list(total_attractiveness = list(pp_offer_attractiveness = 0.35,
cp_offer_attractiveness = 0.65),
cp_offer_attractiveness = list(sales_performance = 0.6,
customer_relationship = 0.4),
sales_performance = list(sr_sales_performance = 0.6,
field_work = 0.05,
deployment_quality = 0.35),
customer_relaitonship = list(product_knowledge = 0.05,
promotional_support = 0.15,
past_relationship = 0.8),
sr_sales_performance = list(motivation = 0.15,
sales_skills = 0.3,
product_knowledge = 0.05,
time_with_account = 0.5),
deployment_quality = list(kpi_report_analysis =0.4,
admin_work = 0.3,
meetings_with_team = 0.3),
sales_skills = list(field_work = 0.2,
sales_training = 0.3,
experience = 0.5),
motivation = list(admin_work = 0.1,
sales_target_realization =0.4,
meetings_with_team = 0.25,
sales_training = 0.25),
success_value = list(total_sales = 0.3,
contribution_margin = 0.35,
average_customer_relationship = 0.15,
team_capability = 0.2)
)
total_promotional_budget <- list(phase1 = 2000,
phase2 = 2000,
phase3 = 2000,
phase4 = 2000)
colnames(hospital_info)
unique(hospital_info$名称)
hospital_info <- read.xlsx("pre_info.xlsx",
sheet="hospital")
hospital_info<- gather(hospital_info,phase,"潜力",c("周期1","周期2","周期3","周期4"))
hospital_info_ui <- hospital_info[c(1,3,4,5,7,8),]
unique(hospital_info$名称)
str(hospital_info$名称)
View(sr_info)
sr_info_ui
product_info_ui
product_info <- read.xlsx("pre_info.xlsx",
sheet="product")
View(product_info)
product_info_ui <- product_info[-1,]
View(product_info_ui)
product_info <- read.xlsx("pre_info.xlsx",
sheet="product")
product_info_ui <- product_info[,-4]
View(product_info)
View(product_info_ui)
product_info_ui <- product_info[,-1]
View(product_info_ui)
View(sr_info_ui)
hospital_info_ui <- hospital_info[,c(1,3,4,5,7,8)]
View(hospital_info_ui)
colnames(hospital_info_ui)
hospital_info_ui[,-"phase"]
hospital_info_ui[,-c("phase")]
select(hospital_info_ui[which(hospital_info_ui$phase=="周期1"),-1],)
select(hospital_info_ui[which(hospital_info_ui$phase=="周期1"),],-phase)
View(select(hospital_info_ui[which(hospital_info_ui$phase=="周期1"),],-phase))
View(hospital_info)
hospital_info[which(hospital_info$phase=="周期1"&
hospital_info$hosp_code==1&
hospital_info$prod_code==1),]$潜力
View(pp_info)
View(pp_info)
pp_info[which(pp_info$phase=="周期1"&
pp_info$hosp_code==1&
pp_info$prod_code==1),]$pp_real_revenue
pp_info[which(pp_info$hosp_code==1&
pp_info$prod_code==4),]$pp_real_revenue
pp_info[which(pp_info$hosp_code==1&
pp_info$prod_code==1),]$pp_real_revenue
colnames(hospital_info)
colnames(product_info)
hospital_info$hospital[5]
hospital_info$名称
unique(hospital_info$名称)
