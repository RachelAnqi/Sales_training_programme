colnames(pp_data2)[3:10] <- paste("pp_",colnames(pp_data2)[3:10],sep="")
cp_data1 <- get.data1(input,1)
cp_data2 <- get.data2(input,1)
tmp <- calculation(pp_data1,
pp_data2,
cp_data1,
cp_data2)
p1_flm_data <- get.data3(input,1)
p1_report <- report_data(tmp,p1_flm_data,p0_report$report8_mod1)
p1_report$report1_mod2
get("p1_report$report1_mod2")
p1_report[["report1_mod2"]]
View(p1_report[["report1_mod2"]])
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test", p1_report$report1_mod2,startCol=1)
writeDataTable(wb, sheet = "test", p1_report$report1_mod2,startCol=10)
saveWorkbook(wb,
file = "test.xlsx",
overwrite = TRUE)
getwd()
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test", p1_report$report1_mod2,startRow=1,rowNames=T)
writeDataTable(wb, sheet = "test", p1_report$report1_mod3,startRow=10,rowNames=T)
saveWorkbook(wb,
file = "test.xlsx",
overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test",withFilter = F, p1_report$report1_mod2,startRow=1,rowNames=T)
writeDataTable(wb, sheet = "test",withFilter = F, p1_report$report1_mod3,startRow=10,rowNames=T)
saveWorkbook(wb,
file = "test.xlsx",
overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test",withFilter = F,tableName ="ssss", p1_report$report1_mod2,startRow=1,rowNames=T)
writeDataTable(wb, sheet = "test",withFilter = F,tableName= "wwe", p1_report$report1_mod3,startRow=10,rowNames=T)
saveWorkbook(wb,
file = "test.xlsx",
overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test",withFilter = F,tableName ="ssss", p1_report$report1_mod2,startRow=1,rowNames=T)
writeDataTable(wb, sheet = "test",withFilter = F,tableName= "wwe", p1_report$report1_mod3,startRow=10,rowNames=T)
saveWorkbook(wb,
file = "test.xlsx",
overwrite = TRUE)
x <- datatable(p1_report$report1_mod2,
rownames = F,
caption="利润贡献 每客户",
options =
list(pageLength = 120,
ordering = F, dom = "t",
columnDefs = list(list(className = 'dt-center', width = "250px", targets = "_all")),
initComplete = JS(
"function(settings, json) {",
"$(this.api().table().header()).css({'background-color': '#41555D', 'color': '#fff'});",
"}")))
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test",withFilter = F,tableName ="ssss", x,startRow=1,rowNames=T)
writeDataTable(wb, sheet = "test",withFilter = F,tableName= "wwe", p1_report$report1_mod3,startRow=10,rowNames=T)
saveWorkbook(wb,
file = "test.xlsx",
overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test",withFilter = F,caption ="ssss", p1_report$report1_mod2,startRow=1,rowNames=T)
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test",withFilter = F, "商业价值",startRow=1,rowNames=T)
writeDataTable(wb, sheet = "test",withFilter = F, p1_report$report1_mod2,startRow=2,rowNames=T)
writeDataTable(wb, sheet = "test",withFilter = F, "商业价值",startRow=1,rowNames=F)
writeDataTable(wb, sheet = "test",withFilter = F, data.frame("商业价值"),startRow=1,rowNames=F)
writeDataTable(wb, sheet = "test",withFilter = F, data.frame("商业价值"),startRow=11,rowNames=F)
wb <- createWorkbook()
addWorksheet(wb, "test")
wb <- createWorkbook()
addWorksheet(wb, "test")
writeDataTable(wb, sheet = "test",withFilter = F, data.frame("商业价值"),startRow=1,rowNames=F,colNames = F)
writeDataTable(wb, sheet = "test",withFilter = F, p1_report$report1_mod2,startRow=2,rowNames=T)
writeDataTable(wb, sheet = "test",withFilter = F, p1_report$report1_mod3,startRow=10,rowNames=T)
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, data.frame("商业价值"),startRow=1,rowNames=F,colNames = F)
writeDataTable(wb1, sheet = "test",withFilter = F, p1_report$report1_mod2,startRow=2,rowNames=T)
writeDataTable(wb1, sheet = "test",withFilter = F, p1_report$report1_mod3,startRow=10,rowNames=T)
saveWorkbook(wb1,
file = "test.xlsx",
overwrite = TRUE)
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, data.frame(`` = "商业价值"),startRow=1,rowNames=F,colNames = F)
tmp <- cbind(`` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F,tmp,startRow=2,rowNames=F)
tmp <- cbind(`` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F, tmp,startRow=10,rowNames=F)
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, data.frame(`` = "商业价值"),startRow=1,rowNames=F,colNames = F)
tmp <- cbind(`` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F,tmp,startRow=2,rowNames=F)
tmp <- cbind(`` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F, tmp,startRow=10,rowNames=F)
tmp <- cbind(`` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
rownames(p1_report$report1_mod2 )
p1_report$report1_mod2
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
tmp
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, data.frame(`` = "商业价值"),startRow=1,rowNames=F,colNames = F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F,tmp,startRow=2,rowNames=F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F, tmp,startRow=10,rowNames=F)
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, data.frame(` ` = "商业价值"),startRow=1,rowNames=F,colNames = F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F,tmp,startRow=2,rowNames=F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F, tmp,startRow=10,rowNames=F)
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, data.frame(` ` = "商业价值"),startRow=1,rowNames=F,colNames = F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F,tmp,startRow=3,rowNames=F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F, tmp,startRow=10,rowNames=F)
saveWorkbook(wb1,
file = "test.xlsx",
overwrite = TRUE)
data.frame(` ` = "商业价值")
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, data.frame(` ` = "商业价值"),startRow=1,rowNames=F,colNames = T)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F,tmp,startRow=3,rowNames=F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F, tmp,startRow=10,rowNames=F)
## 报告保存
saveWorkbook(wb1,
file = "test.xlsx",
overwrite = TRUE)
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, tibble(` ` = "商业价值"),startRow=1,rowNames=F,colNames = T)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F,tmp,startRow=3,rowNames=F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F, tmp,startRow=10,rowNames=F)
## 报告保存
saveWorkbook(wb1,
file = "test.xlsx",
overwrite = TRUE)
wb1 <- createWorkbook()
addWorksheet(wb1, "test")
writeDataTable(wb1, sheet = "test",withFilter = F, tibble(商业价值 = " "),startRow=1,rowNames=F,colNames = T)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F,tmp,startRow=3,rowNames=F)
tmp <- cbind(` ` = rownames(p1_report$report1_mod2 ), p1_report$report1_mod2)
writeDataTable(wb1, sheet = "test",withFilter = F, tmp,startRow=10,rowNames=F)
## 报告保存
saveWorkbook(wb1,
file = "test.xlsx",
overwrite = TRUE)
report <- p1_report
report$report1_mod1
report$report1_mod2
rbind(report$report1_mod3,report$report1_mod4)
View(rbind(report$report1_mod3,report$report1_mod4))
writeDown <- function(phase,report,report8){
wb <- createWorkbook()
## 1
addWorksheet(wb, rsd_sheet_names[1])
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, tibble(商业价值 = " "),
startRow = 1,rowNames = F,colNames = T)
report8_1 <- cbind(` `= rownames(report8),report8)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, report8_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, tibble(销售业绩 = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report8_2 <- cbind(` `= rownames(report$report8_mod2),report$report8_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, report8_2,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 2
addWorksheet(wb, rsd_sheet_names[2])
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, tibble(时间分配 = " "),
startRow = 1,rowNames = F,colNames = T)
report1_1 <- cbind(` `= rownames(report$report1_mod2),report$report1_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, report1_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, tibble(各项指标 = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report8_2 <- rbind(report$report1_mod3,
report$report1_mod4,
report$report1_mod5,
report$report1_mod6)
report8_2 <- cbind(` `= rownames(report8_2),report8_2)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, report8_2,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 3
addWorksheet(wb, rsd_sheet_names[3])
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, tibble(职员成本 = " "),
startRow = 1,rowNames = F,colNames = T)
report1_1 <- cbind(` `= rownames(report$report2_mod1),report$report2_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, report1_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, tibble(时间分配 = " "),
startCol = 1,startRow = 4,rowNames = F,colNames = T)
report1_2 <- cbind(` `= rownames(report$report2_mod2),report$report2_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, report1_2,
startCol = 2,startRow = 4,rowNames = F,colNames = T)
## 4
addWorksheet(wb, rsd_sheet_names[4])
writeDataTable(wb, sheet = rsd_sheet_names[4],withFilter = F, tibble(时间分配 = " "),
startRow = 1,rowNames = F,colNames = T)
report3_1 <- report$report3_mod1
writeDataTable(wb, sheet = rsd_sheet_names[4],withFilter = F, report3_1,
startCol = 2,rowNames = F,colNames = T)
## 5
addWorksheet(wb, rsd_sheet_names[5])
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, tibble("利润贡献 每产品(总)" = " "),
startRow = 1,rowNames = F,colNames = T)
report5_1 <- cbind(` `= rownames(report$report5_mod1),report$report5_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, report5_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, tibble("利润贡献 (总体)" = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report5_2 <- cbind(` `= rownames(report$report5_mod2),report$report5_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, report5_2,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 6
addWorksheet(wb, rsd_sheet_names[6])
writeDataTable(wb, sheet = rsd_sheet_names[6],withFilter = F, tibble("利润贡献 每客户 " = " "),
startRow = 1,rowNames = F,colNames = T)
report6_1 <- report$report6_mod1
writeDataTable(wb, sheet = rsd_sheet_names[6],withFilter = F, report6_1,
startCol = 2,rowNames = F,colNames = T)
## 7
addWorksheet(wb, rsd_sheet_names[7])
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/客户" = " "),
startRow = 1,rowNames = F,colNames = T)
report7_1 <- cbind(` `= rownames(report$report7_mod1),report$report7_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/代表" = " "),
startCol = 1,startRow = 14,rowNames = F,colNames = T)
report7_2 <- cbind(` `= rownames(report$report7_mod2),report$report7_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_2,
startCol = 2,startRow = 14,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/产品" = " "),
startCol = 1,startRow = 22,rowNames = F,colNames = T)
report7_3 <- cbind(` `= rownames(report$report7_mod3),report$report7_mod3)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_3,
startCol = 2,startRow = 22,rowNames = F,colNames = T)
return(wd)}
p1_report$report8_mod1
report8_mod1 <- p1_report$report8_mod1
report8_mod1 <- report8_mod1 %>%
gather(variable,`值`,-phase) %>%
spread(phase,`值`)
report8_mod1 <- report8_mod1 %>%
left_join(report8_mod1_rank,by="variable") %>%
arrange(rank) %>%
select(-variable,-rank)
rownames(report8_mod1) <- report8_mod1$name
report8_mod1 <- report8_mod1 %>%
select(-name)
View9report8_mod1
report8_mod1
saveWorkbook(writeDown("phase1",p1_report,report8_mod1),
file = "test.csv",
overwrite = TRUE)
rsd_sheet_names <- c("市场销售报告",
"代表报告",
"经理报告",
"分配报告",
"利润贡献总体报告",
"利润贡献客户报",
"销售报告")
saveWorkbook(writeDown("phase1",p1_report,report8_mod1),
file = "test.csv",
overwrite = TRUE)
report5_2 <- cbind(` `= rownames(report$report5_mod2),report$report5_mod2)
report5_2
report$report5_mod2
writeDown <- function(phase,report,report8){
wb <- createWorkbook()
## 1
addWorksheet(wb, rsd_sheet_names[1])
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, tibble(商业价值 = " "),
startRow = 1,rowNames = F,colNames = T)
report8_1 <- cbind(` `= rownames(report8),report8)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, report8_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, tibble(销售业绩 = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report8_2 <- cbind(` `= rownames(report$report8_mod2),report$report8_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, report8_2,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 2
addWorksheet(wb, rsd_sheet_names[2])
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, tibble(时间分配 = " "),
startRow = 1,rowNames = F,colNames = T)
report1_1 <- cbind(` `= rownames(report$report1_mod2),report$report1_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, report1_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, tibble(各项指标 = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report8_2 <- rbind(report$report1_mod3,
report$report1_mod4,
report$report1_mod5,
report$report1_mod6)
report8_2 <- cbind(` `= rownames(report8_2),report8_2)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, report8_2,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 3
addWorksheet(wb, rsd_sheet_names[3])
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, tibble(职员成本 = " "),
startRow = 1,rowNames = F,colNames = T)
report1_1 <- cbind(` `= rownames(report$report2_mod1),report$report2_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, report1_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, tibble(时间分配 = " "),
startCol = 1,startRow = 4,rowNames = F,colNames = T)
report1_2 <- cbind(` `= rownames(report$report2_mod2),report$report2_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, report1_2,
startCol = 2,startRow = 4,rowNames = F,colNames = T)
## 4
addWorksheet(wb, rsd_sheet_names[4])
writeDataTable(wb, sheet = rsd_sheet_names[4],withFilter = F, tibble(时间分配 = " "),
startRow = 1,rowNames = F,colNames = T)
report3_1 <- report$report3_mod1
writeDataTable(wb, sheet = rsd_sheet_names[4],withFilter = F, report3_1,
startCol = 2,rowNames = F,colNames = T)
## 5
addWorksheet(wb, rsd_sheet_names[5])
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, tibble("利润贡献 每产品(总)" = " "),
startRow = 1,rowNames = F,colNames = T)
report5_1 <- cbind(` `= rownames(report$report5_mod1),report$report5_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, report5_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, tibble("利润贡献 (总体)" = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report5_3 <- cbind(` `= rownames(report$report5_mod3),report$report5_mod3)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, report5_3,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 6
addWorksheet(wb, rsd_sheet_names[6])
writeDataTable(wb, sheet = rsd_sheet_names[6],withFilter = F, tibble("利润贡献 每客户 " = " "),
startRow = 1,rowNames = F,colNames = T)
report6_1 <- report$report6_mod1
writeDataTable(wb, sheet = rsd_sheet_names[6],withFilter = F, report6_1,
startCol = 2,rowNames = F,colNames = T)
## 7
addWorksheet(wb, rsd_sheet_names[7])
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/客户" = " "),
startRow = 1,rowNames = F,colNames = T)
report7_1 <- cbind(` `= rownames(report$report7_mod1),report$report7_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/代表" = " "),
startCol = 1,startRow = 14,rowNames = F,colNames = T)
report7_2 <- cbind(` `= rownames(report$report7_mod2),report$report7_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_2,
startCol = 2,startRow = 14,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/产品" = " "),
startCol = 1,startRow = 22,rowNames = F,colNames = T)
report7_3 <- cbind(` `= rownames(report$report7_mod3),report$report7_mod3)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_3,
startCol = 2,startRow = 22,rowNames = F,colNames = T)
return(wd)}
saveWorkbook(writeDown("phase1",p1_report,report8_mod1),
file = "test.csv",
overwrite = TRUE)
writeDown <- function(phase,report,report8){
wb <- createWorkbook()
## 1
addWorksheet(wb, rsd_sheet_names[1])
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, tibble(商业价值 = " "),
startRow = 1,rowNames = F,colNames = T)
report8_1 <- cbind(` `= rownames(report8),report8)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, report8_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, tibble(销售业绩 = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report8_2 <- cbind(` `= rownames(report$report8_mod2),report$report8_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[1],withFilter = F, report8_2,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 2
addWorksheet(wb, rsd_sheet_names[2])
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, tibble(时间分配 = " "),
startRow = 1,rowNames = F,colNames = T)
report1_1 <- cbind(` `= rownames(report$report1_mod2),report$report1_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, report1_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, tibble(各项指标 = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report8_2 <- rbind(report$report1_mod3,
report$report1_mod4,
report$report1_mod5,
report$report1_mod6)
report8_2 <- cbind(` `= rownames(report8_2),report8_2)
writeDataTable(wb, sheet = rsd_sheet_names[2],withFilter = F, report8_2,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 3
addWorksheet(wb, rsd_sheet_names[3])
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, tibble(职员成本 = " "),
startRow = 1,rowNames = F,colNames = T)
report1_1 <- cbind(` `= rownames(report$report2_mod1),report$report2_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, report1_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, tibble(时间分配 = " "),
startCol = 1,startRow = 4,rowNames = F,colNames = T)
report1_2 <- cbind(` `= rownames(report$report2_mod2),report$report2_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[3],withFilter = F, report1_2,
startCol = 2,startRow = 4,rowNames = F,colNames = T)
## 4
addWorksheet(wb, rsd_sheet_names[4])
writeDataTable(wb, sheet = rsd_sheet_names[4],withFilter = F, tibble(时间分配 = " "),
startRow = 1,rowNames = F,colNames = T)
report3_1 <- report$report3_mod1
writeDataTable(wb, sheet = rsd_sheet_names[4],withFilter = F, report3_1,
startCol = 2,rowNames = F,colNames = T)
## 5
addWorksheet(wb, rsd_sheet_names[5])
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, tibble("利润贡献 每产品(总)" = " "),
startRow = 1,rowNames = F,colNames = T)
report5_1 <- cbind(` `= rownames(report$report5_mod1),report$report5_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, report5_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, tibble("利润贡献 (总体)" = " "),
startCol = 1,startRow = 8,rowNames = F,colNames = T)
report5_3 <- cbind(` `= rownames(report$report5_mod3),report$report5_mod3)
writeDataTable(wb, sheet = rsd_sheet_names[5],withFilter = F, report5_3,
startCol = 2,startRow = 8,rowNames = F,colNames = T)
## 6
addWorksheet(wb, rsd_sheet_names[6])
writeDataTable(wb, sheet = rsd_sheet_names[6],withFilter = F, tibble("利润贡献 每客户 " = " "),
startRow = 1,rowNames = F,colNames = T)
report6_1 <- report$report6_mod1
writeDataTable(wb, sheet = rsd_sheet_names[6],withFilter = F, report6_1,
startCol = 2,rowNames = F,colNames = T)
## 7
addWorksheet(wb, rsd_sheet_names[7])
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/客户" = " "),
startRow = 1,rowNames = F,colNames = T)
report7_1 <- cbind(` `= rownames(report$report7_mod1),report$report7_mod1)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_1,
startCol = 2,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/代表" = " "),
startCol = 1,startRow = 14,rowNames = F,colNames = T)
report7_2 <- cbind(` `= rownames(report$report7_mod2),report$report7_mod2)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_2,
startCol = 2,startRow = 14,rowNames = F,colNames = T)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, tibble("销售额和数量/产品" = " "),
startCol = 1,startRow = 22,rowNames = F,colNames = T)
report7_3 <- cbind(` `= rownames(report$report7_mod3),report$report7_mod3)
writeDataTable(wb, sheet = rsd_sheet_names[7],withFilter = F, report7_3,
startCol = 2,startRow = 22,rowNames = F,colNames = T)
return(wb)}
saveWorkbook(writeDown("phase1",p1_report,report8_mod1),
file = "test.csv",
overwrite = TRUE)
saveWorkbook(writeDown("phase1",p1_report,report8_mod1),
file = "test.csv",
overwrite = TRUE)
saveWorkbook(writeDown("phase1",p1_report,report8_mod1),
file = "test.xlsx",
overwrite = TRUE)
setwd("~/")
setwd("D:/Rachel/WorkMaterial/git/Sales_training_programme/server9")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
ui <- fluidPage(
downloadLink("downloadData", "Download")
)
server <- function(input, output) {
# Our dataset
data <- mtcars
output$downloadData <- downloadHandler(
filename = function() {
paste("data-", Sys.Date(), ".csv", sep="")
},
content = function(file) {
write.csv(data, file)
}
)
}
shinyApp(ui, server)
runApp()
paste("mkdir -p /srv/shiny-server/stp/output/",dir_name,sep="")
paste("mkdir -p /srv/shiny-server/stp/output/","dir_name",sep="")
runApp()
gsub("-","_",Sys.Date())
paste("mkdir /srv/shiny-server/stp/users/",1,
"/",1,"_",1,sep="")
runApp()
runApp()
runApp()
plot(curve35,type="l")
runApp()
runApp()
